(()=>{"use strict";function t(t,e,o){document.addEventListener(t,(t=>{t.target.matches(e)&&o(t)}))}const e={project:document.querySelector('[data-template="project"'),projectView:document.querySelector('[data-template="project-view"]'),todo:document.querySelector('[data-template="todo"]')};function o(t){if(null!=t)return document.importNode(t.content,!0)}class n{constructor(t,e){this.name=t,this.color=e,this.id=Date.now().toString(),this.todoList=[]}}const c="todoList.projects",r="todoList.selectedProjectId";function a(){if(c,localStorage.getItem("todoList.projects"))return JSON.parse(localStorage.getItem(c));{const t=[],e=new n("Default","grey");return t.push(e),l(t),s(e.id),t}}function l(t){localStorage.setItem(c,JSON.stringify(t))}function i(){return localStorage.getItem(r)}function s(t){localStorage.setItem(r,t)}function d(){null!=g.sideMenu&&(window.matchMedia("(min-width: 768px)").matches?(g.body.classList.toggle("desktop-open"),g.sideMenu.classList.remove("mobile-open")):(g.body.classList.contains("desktop-open")||g.body.classList.add("desktop-open"),g.sideMenu.classList.toggle("mobile-open")))}function u(){document.querySelectorAll(".modal--active").forEach((t=>{y(t)})),v()}function m(t){y(t),v()}function p(){const t=document.createDocumentFragment();a().forEach((n=>{const c=function(t){const n=o(e.project),c=n.querySelector(".project-name"),r=n.querySelector(".project-color"),a=n.querySelector(".todo-count");return n.querySelector(".project").dataset.projectId=t.id,c.textContent=t.name,a.textContent=t.todoList.length,r.style.color=t.color,n}(n);t.appendChild(c)})),S(g.projectsContainer),g.projectsContainer.appendChild(t)}function f(t){if(null==t)return;const n=function(t){const n=o(e.projectView),c=n.querySelector(".project-view"),r=n.querySelector(".project-name");return c.dataset.projectId=t.id,r.textContent=t.name,n}(t);j(),g.projectViewContainer.appendChild(n)}function j(){S(g.projectViewContainer)}const g={body:document.body,sideMenu:document.querySelector("[data-side-menu]"),overlay:document.getElementById("overlay"),projectsContainer:document.getElementById("projects-container"),projectNameInput:document.getElementById("input-project-name"),projectColorInput:document.getElementById("input-project-color"),projectViewContainer:document.querySelector('[data-container="project-view"]')};function y(t){null!=t&&t.classList.remove("modal--active")}function v(){null!=g.overlay&&g.overlay.classList.remove("active")}function S(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function h(t){t.preventDefault();const e=t.target,o={name:g.projectNameInput.value,color:g.projectColorInput.options[g.projectColorInput.selectedIndex].dataset.cssColor};if(!function(t){return null!=t.name&&""!==t.name.trim()}(o))return;const c=function(t){const e={...t};return e.name=e.name.trim(),e}(o);!function(t){const e=a();e.push(t),l(e)}(new n(c.name,c.color)),p(),e.reset(),m(e.closest(".modal"))}function I(t){return t.closest("[data-project-id]").dataset.projectId}function C(t){return a().filter((e=>e.id===t))[0]}p(),f(C(i())),t("click","[data-header-toggle]",d),t("click","[data-modal-target]",(t=>{(function(t){null!=t&&t.classList.add("modal--active")})(document.querySelector(t.target.dataset.modalTarget)),null!=g.overlay&&g.overlay.classList.add("active")})),t("click","#overlay",u),t("click",'[data-btn="close-modal"]',(t=>{m(t.target.closest(".modal"))})),t("submit",'[data-form="create-project"]',h),t("click",'[data-btn="show-project-view"]',(t=>{const e=I(t.target);if(e===i())return;const o=C(e);s(e),f(o)})),t("click",'[data-btn="delete-project"]',(t=>{const e=I(t.target);!function(t){let e=a();e=e.filter((e=>e.id!==t)),l(e)}(e),p(),e===i()&&(localStorage.removeItem(r),j())}))})();