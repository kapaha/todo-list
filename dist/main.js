(()=>{"use strict";function t(t,e,o){document.addEventListener(t,(t=>{t.target.matches(e)&&o(t)}))}class e{constructor(t,e,o){this.name=t,this.dueDate=e,this.isComplete=!1,this.id=o||C()}}class o{constructor(t,e){this.name=t,this.color=e,this.id=C(),this.todoList=[]}}const n="todoList.projects",c="todoList.selectedProjectId";function r(){if(n,localStorage.getItem("todoList.projects"))return JSON.parse(localStorage.getItem(n));{const t=[],n=function(){const t=new o("Default","grey");return[new e("Brush Teeth","Jan 22 3:30 PM","defaultTodo1"),new e("Make Breakfast","Today 12:00 PM","defaultTodo2"),new e("Study","Tomorrow 9:00 PM","defaultTodo3")].forEach((e=>{t.todoList.push(e)})),t}();return t.push(n),a(t),i(n.id),t}}function a(t){localStorage.setItem(n,JSON.stringify(t))}function d(){return localStorage.getItem(c)}function i(t){localStorage.setItem(c,t)}const u={project:document.querySelector('[data-template="project"'),projectView:document.querySelector('[data-template="project-view"]'),todo:document.querySelector('[data-template="todo"]')};function l(t){if(null!=t)return document.importNode(t.content,!0)}const s="project-row-btn--highlight";function m(){null!=S.sideMenu&&(window.matchMedia("(min-width: 768px)").matches?(S.body.classList.toggle("desktop-open"),S.sideMenu.classList.remove("mobile-open")):(S.body.classList.contains("desktop-open")||S.body.classList.add("desktop-open"),S.sideMenu.classList.toggle("mobile-open")))}function p(){document.querySelectorAll(".modal--active").forEach((t=>{v(t)})),I()}function f(t){v(t),I()}function y(){const t=document.createDocumentFragment();r().forEach((e=>{const o=function(t){const e=l(u.project),o=e.querySelector(".project-name"),n=e.querySelector(".project-color"),c=e.querySelector(".todo-count");return e.querySelector(".project").dataset.projectId=t.id,o.textContent=t.name,c.textContent=t.todoList.length,n.style.color=t.color,t.id===d()&&g(e.querySelector('[data-btn="show-project-view"]')),e}(e);t.appendChild(o)})),w(S.projectsContainer),S.projectsContainer.appendChild(t)}function h(t){if(null==t)return;const e=function(t){const e=l(u.projectView),o=e.querySelector(".project-view"),n=e.querySelector(".project-name"),c=e.querySelector('[data-container="todo-container"]');return o.dataset.projectId=t.id,n.textContent=t.name,t.todoList.forEach((t=>{const e=function(t){const e=l(u.todo),o=e.querySelector(".todo"),n=e.querySelector('[data-checkbox="todo"]'),c=e.querySelector('[data-label="todo-checkbox"]'),r=e.querySelector(".todo-name"),a=e.querySelector(".todo-due-date");return o.dataset.todoId=t.id,n.id=`todo-checkbox-${t.id}`,c.setAttribute("for",`todo-checkbox-${t.id}`),r.textContent=t.name,a.textContent=t.dueDate,e}(t);c.appendChild(e)})),e}(t);j(),S.projectViewContainer.appendChild(e)}function j(){w(S.projectViewContainer)}function g(t){!function(){const t=document.querySelector(".project-row-btn--highlight");null!=t&&t.classList.remove(s)}(),t.classList.add(s)}const S={body:document.body,sideMenu:document.querySelector("[data-side-menu]"),overlay:document.getElementById("overlay"),projectsContainer:document.getElementById("projects-container"),projectNameInput:document.getElementById("input-project-name"),projectColorInput:document.getElementById("input-project-color"),projectViewContainer:document.querySelector('[data-container="project-view"]'),todoNameInput:document.getElementById("input-todo-name"),todoDueDateInput:document.getElementById("input-todo-due-date")};function v(t){null!=t&&t.classList.remove("modal--active")}function I(){null!=S.overlay&&S.overlay.classList.remove("active")}function w(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function C(){return Date.now().toString()}function q(t){t.preventDefault();const e=t.target,n={name:S.projectNameInput.value,color:S.projectColorInput.options[S.projectColorInput.selectedIndex].dataset.cssColor};if(!function(t){return x(t.name)}(n))return;const c=function(t){const e={...t};return e.name=e.name.trim(),e}(n),d=new o(c.name,c.color);!function(t){const e=r();e.push(t),a(e)}(d),y(),k(d),e.reset(),f(e.closest(".modal"))}function b(t){return t.closest("[data-project-id]").dataset.projectId}function L(t){return r().filter((e=>e.id===t))[0]}function k(t){i(t.id),g(function(t){return document.querySelector(`li[data-project-id="${t.id}"]`)}(t)),h(t)}function D(t){t.preventDefault();const o=t.target,n={name:S.todoNameInput.value,dueDate:S.todoDueDateInput.value};if(!function(t){return x(t.name)}(n))return;const c=function(t){const e={...t};return e.name=e.name.trim(),e}(n),i=d();!function(t,e){!function(t,e){const o=r();o.forEach((o=>{o.id===e&&o.todoList.push(t)})),a(o)}(t,e);const o=L(e);h(o),function(t){document.querySelector(`[data-project-id="${t.id}"] [data-todo-count]`).textContent=t.todoList.length}(o)}(new e(c.name,c.dueDate),i),o.reset(),f(o.closest(".modal"))}function x(t){return null!=t&&""!==t.trim()}y(),h(L(d())),t("click","[data-header-toggle]",m),t("click","[data-modal-target]",(t=>{(function(t){null!=t&&t.classList.add("modal--active")})(document.querySelector(t.target.dataset.modalTarget)),null!=S.overlay&&S.overlay.classList.add("active")})),t("click","#overlay",p),t("click",'[data-btn="close-modal"]',(t=>{f(t.target.closest(".modal"))})),t("submit",'[data-form="create-project"]',q),t("submit",'[data-form="create-todo"]',D),t("click",'[data-btn="show-project-view"]',(t=>{const e=b(t.target);e!==d()&&k(L(e))})),t("click",'[data-btn="delete-project"]',(t=>{const e=b(t.target);!function(t){let e=r();e=e.filter((e=>e.id!==t)),a(e)}(e),y(),e===d()&&(localStorage.removeItem(c),j())}))})();