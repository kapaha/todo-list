(()=>{"use strict";function t(t,e,o){document.addEventListener(t,(t=>{t.target.matches(e)&&o(t)}))}class e{constructor(t,e){this.name=t,this.color=e,this.id=Date.now().toString(),this.todoList=[]}}const o="todoList.projects",n="todoList.selectedProjectId";function c(){if(o,localStorage.getItem("todoList.projects"))return JSON.parse(localStorage.getItem(o));{const t=[],o=new e("Default","grey");return t.push(o),r(t),i(o.id),t}}function r(t){localStorage.setItem(o,JSON.stringify(t))}function a(){return localStorage.getItem(n)}function i(t){localStorage.setItem(n,t)}const l={project:document.querySelector('[data-template="project"'),projectView:document.querySelector('[data-template="project-view"]'),todo:document.querySelector('[data-template="todo"]')};function s(t){if(null!=t)return document.importNode(t.content,!0)}const d="project-row-btn--highlight";function u(){null!=h.sideMenu&&(window.matchMedia("(min-width: 768px)").matches?(h.body.classList.toggle("desktop-open"),h.sideMenu.classList.remove("mobile-open")):(h.body.classList.contains("desktop-open")||h.body.classList.add("desktop-open"),h.sideMenu.classList.toggle("mobile-open")))}function m(){document.querySelectorAll(".modal--active").forEach((t=>{v(t)})),S()}function p(t){v(t),S()}function f(){const t=document.createDocumentFragment();c().forEach((e=>{const o=function(t){const e=s(l.project),o=e.querySelector(".project-name"),n=e.querySelector(".project-color"),c=e.querySelector(".todo-count");return e.querySelector(".project").dataset.projectId=t.id,o.textContent=t.name,c.textContent=t.todoList.length,n.style.color=t.color,t.id===a()&&y(e.querySelector('[data-btn="show-project-view"]')),e}(e);t.appendChild(o)})),w(h.projectsContainer),h.projectsContainer.appendChild(t)}function j(t){if(null==t)return;const e=function(t){const e=s(l.projectView),o=e.querySelector(".project-view"),n=e.querySelector(".project-name");return o.dataset.projectId=t.id,n.textContent=t.name,e}(t);g(),h.projectViewContainer.appendChild(e)}function g(){w(h.projectViewContainer)}function y(t){!function(){const t=document.querySelector(".project-row-btn--highlight");null!=t&&t.classList.remove(d)}(),t.classList.add(d)}const h={body:document.body,sideMenu:document.querySelector("[data-side-menu]"),overlay:document.getElementById("overlay"),projectsContainer:document.getElementById("projects-container"),projectNameInput:document.getElementById("input-project-name"),projectColorInput:document.getElementById("input-project-color"),projectViewContainer:document.querySelector('[data-container="project-view"]')};function v(t){null!=t&&t.classList.remove("modal--active")}function S(){null!=h.overlay&&h.overlay.classList.remove("active")}function w(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function I(t){t.preventDefault();const o=t.target,n={name:h.projectNameInput.value,color:h.projectColorInput.options[h.projectColorInput.selectedIndex].dataset.cssColor};if(!function(t){return null!=t.name&&""!==t.name.trim()}(n))return;const a=function(t){const e={...t};return e.name=e.name.trim(),e}(n);!function(t){const e=c();e.push(t),r(e)}(new e(a.name,a.color)),f(),o.reset(),p(o.closest(".modal"))}function C(t){return t.closest("[data-project-id]").dataset.projectId}function L(t){return c().filter((e=>e.id===t))[0]}f(),j(L(a())),t("click","[data-header-toggle]",u),t("click","[data-modal-target]",(t=>{(function(t){null!=t&&t.classList.add("modal--active")})(document.querySelector(t.target.dataset.modalTarget)),null!=h.overlay&&h.overlay.classList.add("active")})),t("click","#overlay",m),t("click",'[data-btn="close-modal"]',(t=>{p(t.target.closest(".modal"))})),t("submit",'[data-form="create-project"]',I),t("click",'[data-btn="show-project-view"]',(t=>{const e=t.target,o=C(e);if(o===a())return;const n=L(o);i(o),y(e),j(n)})),t("click",'[data-btn="delete-project"]',(t=>{const e=C(t.target);!function(t){let e=c();e=e.filter((e=>e.id!==t)),r(e)}(e),f(),e===a()&&(localStorage.removeItem(n),g())}))})();
